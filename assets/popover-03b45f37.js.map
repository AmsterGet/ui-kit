{"version":3,"file":"popover-03b45f37.js","sources":["../../src/components/popover/popover.tsx"],"sourcesContent":["/*\n * Copyright 2024 EPAM Systems\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FC, ReactElement, useRef, useState, ReactNode } from 'react';\nimport {\n  offset,\n  useFloating,\n  FloatingArrow,\n  arrow,\n  flip,\n  autoUpdate,\n  useClick,\n  useDismiss,\n  useRole,\n  useInteractions,\n  FloatingFocusManager,\n  Placement,\n} from '@floating-ui/react';\nimport classNames from 'classnames/bind';\nimport styles from './popover.module.scss';\n\nconst cx = classNames.bind(styles);\nconst TRIANGLE_WIDTH = 16;\nconst TRIANGLE_HEIGHT = 8;\nconst middlePlacements: Placement[] = ['top', 'right', 'bottom', 'left'];\nconst verticalPlacements: Placement[] = [\n  'right',\n  'right-start',\n  'right-end',\n  'left',\n  'left-start',\n  'left-end',\n];\nconst allPlacements: Placement[] = [\n  'top',\n  'top-start',\n  'top-end',\n  'right',\n  'right-start',\n  'right-end',\n  'bottom',\n  'bottom-start',\n  'bottom-end',\n  'left',\n  'left-start',\n  'left-end',\n];\n\ninterface PopoverProps {\n  className?: string;\n  content: ReactNode;\n  children: ReactNode;\n  placement?: Placement;\n  fallbackPlacements?: Placement[];\n  title?: string;\n  arrowOffset?: number;\n  safeZone?: number;\n  arrowColor?: string;\n  dataAutomationId?: string;\n  isOpened?: boolean;\n  setIsOpened?: (isOpened: boolean) => void;\n}\n\nexport const Popover: FC<PopoverProps> = ({\n  className,\n  content,\n  children,\n  placement: initialPlacement = 'bottom',\n  fallbackPlacements = allPlacements,\n  title,\n  arrowOffset = 16,\n  safeZone = 4,\n  arrowColor = 'white',\n  dataAutomationId,\n  isOpened,\n  setIsOpened,\n}): ReactElement => {\n  const arrowRef = useRef(null);\n  const [isOpen, setIsOpen] = useState(false);\n\n  const isPopoverOpen = setIsOpened ? isOpened : isOpen;\n\n  const onOpenChange = (isPopoverOpened: boolean) => {\n    if (setIsOpened) {\n      setIsOpened(isPopoverOpened);\n    } else {\n      setIsOpen(isPopoverOpened);\n    }\n  };\n\n  const { placement, refs, floatingStyles, context } = useFloating({\n    open: isPopoverOpen,\n    onOpenChange,\n    placement: initialPlacement,\n    middleware: [\n      offset(({ rects, placement: currentPlacement }) => ({\n        mainAxis: safeZone + TRIANGLE_HEIGHT,\n        alignmentAxis:\n          ((verticalPlacements.includes(currentPlacement)\n            ? rects.reference.height\n            : rects.reference.width) -\n            TRIANGLE_WIDTH) /\n            2 -\n          arrowOffset,\n      })),\n      flip({\n        fallbackAxisSideDirection: 'start',\n        fallbackPlacements: fallbackPlacements,\n      }),\n      arrow({\n        element: arrowRef,\n      }),\n    ],\n    whileElementsMounted: autoUpdate,\n  });\n\n  const click = useClick(context);\n  const dismiss = useDismiss(context);\n  const role = useRole(context);\n\n  const { getReferenceProps, getFloatingProps } = useInteractions([click, dismiss, role]);\n\n  return (\n    <>\n      <div ref={refs.setReference} {...getReferenceProps()} className={cx('popover-wrapper')}>\n        {children}\n      </div>\n      {isPopoverOpen && (\n        <FloatingFocusManager context={context} modal={false}>\n          <div\n            className={cx('popover', className)}\n            data-automation-id={dataAutomationId}\n            ref={refs.setFloating}\n            style={floatingStyles}\n            {...getFloatingProps}\n          >\n            <FloatingArrow\n              ref={arrowRef}\n              context={context}\n              width={TRIANGLE_WIDTH}\n              height={TRIANGLE_HEIGHT}\n              fill={arrowColor}\n              staticOffset={middlePlacements.includes(placement) ? null : arrowOffset}\n            />\n            {title && <div className={cx('title')}>{title}</div>}\n            {content}\n          </div>\n        </FloatingFocusManager>\n      )}\n    </>\n  );\n};\n"],"names":["cx","classNames","styles","TRIANGLE_WIDTH","TRIANGLE_HEIGHT","middlePlacements","verticalPlacements","allPlacements","Popover","className","content","children","initialPlacement","fallbackPlacements","title","arrowOffset","safeZone","arrowColor","dataAutomationId","isOpened","setIsOpened","arrowRef","useRef","isOpen","setIsOpen","useState","isPopoverOpen","onOpenChange","isPopoverOpened","placement","refs","floatingStyles","context","useFloating","offset","rects","currentPlacement","flip","arrow","autoUpdate","click","useClick","dismiss","useDismiss","role","useRole","getReferenceProps","getFloatingProps","useInteractions","jsxs","Fragment","jsx","FloatingFocusManager","FloatingArrow"],"mappings":"mXAkCAA,EAAAC,EAAA,KAAAC,CAAA,EACAC,EAAA,GACAC,EAAA,EACAC,EAAA,CAAA,MAAA,QAAA,SAAA,MAAA,EACAC,EAAA,CAAwC,QACtC,cACA,YACA,OACA,aACA,UAEF,EACAC,EAAA,CAAmC,MACjC,YACA,UACA,QACA,cACA,YACA,SACA,eACA,aACA,OACA,aACA,UAEF,EAiBOC,EAAA,CAAA,CAAmC,UAAAC,EACxC,QAAAC,EACA,SAAAC,EACA,UAAAC,EAAA,SAC8B,mBAAAC,EAAAN,EACT,MAAAO,EACrB,YAAAC,EAAA,GACc,SAAAC,EAAA,EACH,WAAAC,EAAA,QACE,iBAAAC,EACb,SAAAC,EACA,YAAAC,CAEF,IAAA,CACE,MAAAC,EAAAC,SAAA,IAAA,EACA,CAAAC,EAAAC,CAAA,EAAAC,EAAA,SAAA,EAAA,EAEAC,EAAAN,EAAAD,EAAAI,EAEAI,EAAAC,GAAA,CACER,EACEA,EAAAQ,CAAA,EAEAJ,EAAAI,CAAA,CACF,EAGF,CAAA,UAAAC,EAAA,KAAAC,EAAA,eAAAC,EAAA,QAAAC,CAAA,EAAAC,EAAA,CAAiE,KAAAP,EACzD,aAAAC,EACN,UAAAf,EACW,WAAA,CACCsB,EAAA,CAAA,CAAA,MAAAC,EAAA,UAAAC,CAAA,KAAA,CAC0C,SAAApB,EAAAZ,EAC7B,gBAAAE,EAAA,SAAA8B,CAAA,EAAAD,EAAA,UAAA,OAAAA,EAAA,UAAA,OAAAhC,GAAA,EAAAY,CAOnB,EAAA,EACFsB,EAAA,CACG,0BAAA,QACwB,mBAAAxB,CAC3B,CAAA,EACDyB,EAAA,CACK,QAAAjB,CACK,CAAA,CACV,EACH,qBAAAkB,CACsB,CAAA,EAGxBC,EAAAC,EAAAT,CAAA,EACAU,EAAAC,EAAAX,CAAA,EACAY,EAAAC,EAAAb,CAAA,EAEA,CAAA,kBAAAc,EAAA,iBAAAC,GAAAC,EAAA,CAAAR,EAAAE,EAAAE,CAAA,CAAA,EAEA,OAAAK,EAAA,KAAAC,WAAA,CAAA,SAAA,CAEIC,EAAAA,IAAA,MAAA,CAAA,IAAArB,EAAA,aAAA,GAAAgB,EAAA,EAAA,UAAA9C,EAAA,iBAAA,EAAA,SAAAW,CAAA,CAAA,EAEAe,GAAAyB,EAAA,IAAAC,EAAA,CAAA,QAAApB,EAAA,MAAA,GAAA,SAAAiB,EAAA,KAGI,MAAC,CAAA,UAAAjD,EAAA,UAAAS,CAAA,EACmC,qBAAAS,EACd,IAAAY,EAAA,YACV,MAAAC,EACH,GAAAgB,EACH,SAAA,CAEJI,EAAA,IAAAE,EAAC,CAAA,IAAAhC,EACM,QAAAW,EACL,MAAA7B,EACO,OAAAC,EACC,KAAAa,EACF,aAAAZ,EAAA,SAAAwB,CAAA,EAAA,KAAAd,CACsD,CAAA,EAC9DD,GAAAqC,EAAAA,IAAA,MAAA,CAAA,UAAAnD,EAAA,OAAA,EAAA,SAAAc,EAAA,EAC8CJ,CAC7C,CAAA,CAAA,EAAA,CAEL,CAAA,CAAA,CAIR;;;;;;;;;;;;;"}